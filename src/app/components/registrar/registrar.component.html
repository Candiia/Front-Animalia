<section class="vh-100 gradient-custom">
    <div class="container py-5 h-100">
        <div class="row justify-content-center align-items-center h-100">
            <div class="col-12 col-sm-10 col-md-8 col-lg-6 col-xl-5">
                <div class="card bg-light text-white w-100" style="border-radius: 1rem;">
                    <div class="card-body px-3 px-md-5 py-4 text-center">

                        <form #form="ngForm" (ngSubmit)="registerUser()">

                            <img class="img-fluid mb-4" src="/assets/logo.png" alt="logo" style="max-width: 150px;">
                            <p class="text-dark fs-4 fw-semibold mb-4">¡Crea tu cuenta!</p>

                            <div *ngIf="successMessage" class="alert alert-success text-dark py-2 mb-3">
                                {{ successMessage }}
                            </div>

                            <!-- Username -->
                            <div class="form-outline mb-3 position-relative">
                                <i
                                    class="bi bi-person-fill position-absolute start-0 translate-middle-y ms-3 text-secondary"
                                    style="top: 40%; transform: translateY(-40%);"></i>
                                <input
                                    type="text"
                                    class="form-control form-control-lg ps-5"
                                    placeholder="Username"
                                    name="username"
                                    [(ngModel)]="username"
                                    #usernameField="ngModel"
                                    required
                                    [ngClass]="{'is-invalid': usernameTaken || (usernameField.invalid && usernameField.touched)}" />
                                <div class="invalid-feedback d-block" *ngIf="usernameTaken">
                                    El nombre de usuario ya existe.
                                </div>
                                <div class="invalid-feedback d-block"
                                    *ngIf="usernameField.invalid && usernameField.touched && !usernameTaken">
                                    El nombre de usuario es obligatorio.
                                </div>
                            </div>

                            <!-- Email -->
                            <div class="form-outline mb-3 position-relative">
                                <i
                                    class="bi bi-envelope position-absolute start-0 translate-middle-y ms-3 text-secondary"
                                    style="top: 40%; transform: translateY(-40%);"></i>
                                <input
                                    type="email"
                                    class="form-control form-control-lg ps-5"
                                    placeholder="Email"
                                    name="email"
                                    [(ngModel)]="email"
                                    #emailField="ngModel"
                                    required
                                    email
                                    [ngClass]="{'is-invalid': emailField.invalid && emailField.touched}" />
                                <div class="invalid-feedback d-block" *ngIf="emailField.invalid && emailField.touched">
                                    Introduce un correo válido.
                                </div>
                            </div>

                            <!-- Password -->
                            <div class="form-outline mb-3 position-relative">
                                <i
                                    class="bi bi-lock-fill position-absolute start-0 translate-middle-y ms-3 text-secondary"
                                    style="top: 40%; transform: translateY(-40%);"></i>
                                <input
                                    type="password"
                                    class="form-control form-control-lg ps-5"
                                    placeholder="Contraseña"
                                    name="password"
                                    [(ngModel)]="password"
                                    #passwordField="ngModel"
                                    required
                                    minlength="6"
                                    [ngClass]="{'is-invalid': passwordField.invalid && passwordField.touched}" />
                                <div class="invalid-feedback d-block" *ngIf="passwordField.invalid && passwordField.touched">
                                    La contraseña debe tener al menos 6 caracteres.
                                </div>
                            </div>

                            <!-- Verify Password -->
                            <div class="form-outline mb-4 position-relative">
                                <i
                                    class="bi bi-lock-fill position-absolute start-0 translate-middle-y mb-2 ms-3 text-secondary"
                                    style="top: 40%; transform: translateY(-40%);"></i>
                                <input
                                    type="password"
                                    class="form-control form-control-lg ps-5"
                                    placeholder="Confirmar Contraseña"
                                    name="verifyPassword"
                                    [(ngModel)]="verifyPassword"
                                    #verifyPasswordField="ngModel"
                                    required
                                    [ngClass]="{'is-invalid': verifyPasswordField.touched && password !== verifyPassword}" />
                                <div class="invalid-feedback d-block"
                                    *ngIf="verifyPasswordField.touched && password !== verifyPassword">
                                    Las contraseñas no coinciden.
                                </div>
                            </div>

                            <button class="btn btn-outline-dark btn-lg w-100" type="submit" [disabled]="form.invalid">
                                Registrarse
                            </button>

                        </form>

                        <div class="mt-3">
                            <a routerLink="/login" class="text-dark fw-bold">¿Ya tienes cuenta? Inicia sesión</a>
                        </div>

                    </div>
                </div>
            </div>
        </div>
    </div>
</section>
